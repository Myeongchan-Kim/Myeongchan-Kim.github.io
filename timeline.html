<!--timeline.html-->
<!doctype html>
<html>
<head>
	<title>timeline</title>
	<meta charset="UTF-8">
	<!-- icon font -->
	<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.4.0/css/font-awesome.min.css">
	<!--<link rel="stylesheet" href="https://i.icomoon.io/public/temp/79645f19e6/UntitledProject/style.css">-->
	<link rel="stylesheet" href="./css/timeline.css">
</head>
<body>
<header id="global-header">
<form action="" method="GET" >
<div id="wrap_title">
	<div id="fa_icon_box" class="title_box">
		<a href=""><i id="facebook-icon"class="fa fa-facebook-official"></i></a>
	</div>
	<div id="main_title_box" class="title_box">
		<div id="search">
			<input type="text" id="search_input" placeholder="Search.">
			<i id="serch_icon" class="fa fa-search"></i>
		</div>
	</div>
		<div id="title_menu_box" class="title_box">
		<ul id="title_menu_list">
			<li id="profile_box" class="titlebar_icon">
				<a href="https://www.linkedin.com/in/myeongchankim/" class="bg-dark">
				<img src="./src/my_pic.jpg" id="profile_img">
				<span id="profile_name">MC Kim</span>
				</a>
			</li>
			<li id="home_button" class="titlebar_icon">
				<a href=""  class="bg-dark">
				<span>Home</span>
				</a>
			</li>
			<div id="msg_frnd_noti">
			<li id="friend_button" class="titlebar_icon">
				<a href="" class="icon-dark"><span><i id="friends_icon" class="fa fa-users"></i></span></a>
			</li>
			<li id="message_button" class="titlebar_icon">
				<a href="" class="icon-dark"><span><i class="fa fa-comments"></i></span>
				</a>
			</li>
			<li id="notice_button" class="titlebar_icon">
				<a href="" class="icon-dark"><span><i class="fa fa-globe"></i></span></a>
			</li>
			</div>
			<li id="lock_button" class="titlebar_icon">
				<a href="" class="icon-dark"><span><i class="fa fa-lock"></i></span></a>
			</li>
			<li id="see_more_button" class="titlebar_icon">
				<a href="" class="icon-dark"><span><i class="fa fa-caret-down"></i></span></a>
			</li>
		</ul>
		</div>
	
</div>
</form>
</header>
<main id="global_main">
	<section id="left_side" class="column">
		<div id="divOfMine" class="left_submenu">
		<ul>
			<li><div><a href="https://www.linkedin.com/in/myeongchankim/"><img src="./src/my_pic.jpg"><span>Myeongchan Kim,MD.</span></a></div>
			</li>
			<li><div><a><img src="./src/write_icon.png"><span>Profile</span></a></div>
			</li>
		</ul>
		</div>
		<div id="fav_nav" class="left_submenu">
		<h3>Favorites</h3>
		<ul>
			<li id="newfeed_button" class="bg-dark">
				<div id="nb_first"><a class="bg-dark">
					<img src="./src/nf_icon.png">
					<span>Deep learning</span>
				</a></div>
				<div id="nb_second" class="bg-dark"><i class="fa fa-caret-down"></i>
				</div>
			</li>
			<li id="newfeed_button" class="bg-dark">
				<div id="nb_first"><a class="bg-dark">
					<img src="./src/healthcare.png">
					<span>Health care</span>
				</a></div>
				<div id="nb_second" class="bg-dark"><i class="fa fa-caret-down"></i>
				</div>
			</li>
			<li class="bg-dark">
				<div><a href="http://www.bostonbaseball.com/">
					<img src="./src/msg_icon.png">
					<span class="menuWithNum">Baseball</span>
				</a></div>
			</li>
			<li class="bg-dark">
				<div><a href="https://codingcompetitions.withgoogle.com/codejam/archive">
					<img src="./src/event_icon.png">
					<span class="menuWithNum">Competitive Progr...</span>
				</a></div>
			</li>
		</ul>
		</div>
		<div id="group_nav" class="left_submenu">
		<h3>Groups<span class="see_more"><a>more</a></span></h3>
		<ul>
			<li class="bg-dark">
			<div><a href="https://www.radnet.com/">
				<img src="./src/radnet.com.ico">
				<span class="menuWithNum">RadNet</span>
				<span class="numWithMenu">20+</span>
			</a></div>
			</li>
			<li class="bg-dark">
			<div><a href="https://www.fevercoach.net/?lang=en">
				<img src="./src/fevercoach.png">
				<span class="menuWithNum">열나요 (FeverCo...</span>
				<span class="numWithMenu">20+</span></a></div>
			</li>
			<li class="bg-dark">
			<div><a href="http://lmic.mgh.harvard.edu/">
				<img src="./src/mgh.png">
				<span class="menuWithNum">Mass General H...</span>
				<span class="numWithMenu">19</span></a></div>
			</li>
		</ul>
		</div>
		<div id="app_nav" class="left_submenu">
		<h3>Apps<span class="see_more"><a>more</a></span></h3>
		<ul>
			<li class="bg-dark">
			<div><a>
				<img src="./src/game_icon.png">
				<span class="menuWithNum">Game</span>
				<span class="numWithMenu"></span></a></div>
			</li>
			<li class="bg-dark"><div><a href="https://play.google.com/store/apps/details?id=com.dep.x10&hl=en">
				<img src="./src/quitenight.png">
				<span class="menuWithNum">Quite Night</span>
				<span class="numWithMenu"></span></a></div>
			</li>
		</ul>
		</div>
		<!--for test -->
		
		<button onclick="window.location='mailto:myeongchan.kim.md@gmail.com';">Add a project!</button>
	</section><!--left_side-->
	<secion id="content" class="column">
		<article id="input_art_div" class="arts">
		<div class="input_art">
			What's on your mind?
		</div>
		</article>
		<article class="arts article" >
			<div class="art_content">
			<p class="art_author_name">
				<a href="https://www.linkedin.com/in/myeongchankim/">Myeongchan Kim</a>
			</p>
			<p class="art_text">
			Commodo veniam fugiat amet do magna aliquip labore sunt anim enim. Sit excepteur incididunt duis occaecat eiusmod Lorem pariatur qui irure ipsum occaecat exercitation elit enim. Laboris laborum ex ex commodo non non laborum aliqua eiusmod do dolore commodo amet veniam. Eiusmod aliquip esse quis eiusmod ipsum culpa laborum. Ut qui non Lorem ea ea ut eiusmod aliqua consectetur sunt.
			</p>
			<div class="art_img_div">
			<img class="art_img" src="./src/1.png" />
			</div>
			</div>
			<div class="art_footer">
				<div class="art_stats">
				<a>
					<span><span class="like_num">12</span> Likes</span>
					<span><span class="comment_num">3</span> Comment</span>
					<span><span class="shared_num">0</span> Share</span>	
				</a>
				</div>
				<div class="art_buttons">
				<span class="like_button">
					<a class="button_a">
					<i class="like_icon fa fa-thumbs-up"></i>
					<span class="button_text">Like</span>
					</a>
				</span>
				<span class="comment_button">
					<a class="button_a">
					<i class="comment_icon fa fa-comment"></i>
					<span class="button_text">Comment</span>
					</a>
				</span>
				<span class="shared_button">
					<a class="button_a">
					<i class="share_icon fa fa-share"></i>
					<span class="button_text">Share</span>
					</a>
				</span>
				</div>
			</div>
		</article>
	</secion><!--#content-->
	<section id="ad_col" class="column">
		<article id="my_page_art" class="ad_arts">
		<p class="ads">
		</p>
		</article>
		<article class="ad_arts">
		<p class="ads">
		</p>
		</article>
	</section>
</main>
<footer>
<div></div>
</footer>
<script>

var article_id = 0;
var article_loading = 0;

function load_json(num){
	var xhr = new XMLHttpRequest();;
	xhr.open('GET', 'https://myeongchan-kim.github.io/JSON/page'+num+'.JSON', true);
	xhr.onreadystatechange = function() {
		if (this.readyState === 4){
			var art_info = JSON.parse(this.responseText);
			//console.log(art_info);
			var new_art = make_article(); // clone of last article
			
			var art_author_name = new_art.querySelector(".art_author_name");
			art_author_name.innerHTML = art_info.name.first + art_info.name.last;
			//console.log(art_author_name);

			var art_text = new_art.querySelector(".art_text");
			art_text.innerHTML = art_info.text;
			//console.log(art_text);
			
			var art_img = new_art.querySelector(".art_img");
			art_img.src = art_info.picture;
			//console.log(art_img);

			var art_like_num = new_art.querySelector(".like_num");
			art_like_num.innerHTML = art_info.like;
			var art_comment_num = new_art.querySelector(".comment_num");
			art_comment_num.innerHTML = art_info.comment;
			var art_shared_num = new_art.querySelector(".shared_num");
			art_shared_num.innerHTML = art_info.shared;

			if(art_info.isLike){
				var eventA = new_art.querySelector('.button_a');
				eventA.classList.toggle('blue');
				var eventIcon = new_art.querySelector('i');
				//console.log(eventA);
				eventIcon.classList.toggle('blue');
			}

			main_content.appendChild(new_art);
			article_loading--;
		}
	};
	xhr.send();
}

function make_article(){
	var art = document.querySelector("main #content > article:last-child");
	var new_art = document.createElement("article");

	new_art.className = art.className;
	new_art.innerHTML = art.innerHTML;
	if(new_art.classList.contains("focus"))
		new_art.classList.remove("focus");

	return new_art;
}

function clone(obj) {
    if (null == obj) return null;
    var copy = obj.constructor();
    for (var attr in obj) {
        if (obj.hasOwnProperty(attr)) copy[attr] = obj[attr];
    }
    return copy;
}

function add_article(article_id){
	var id = (article_id % 5 )+1;
	console.log("article_id="+article_id+"  article_loading="+article_loading);
	load_json(id);
}

function scroll_down(){
	var top = document.querySelector("body").scrollTop;
	//var docH = document.offsetHeight;
	var docH = document.querySelector("#global_main").offsetHeight;
	var screenH = window.screen.height;
	var remain = docH - scrollY - screenH;
	
	//console.log("docH:"+docH+" scrH:"+screenH+" top:"+top+" remain:"+remain+" Add article!");
	if(remain < 100 && article_loading < 1){
		article_id++;
		article_loading++;
		add_article(article_id);
	}
	return remain;
}

function keydown(event){
	if(event.keyCode === 74 || event.keyCode=== 75){
		if(document.activeElement.tagName === "INPUT")
			return;
		//console.log(event.keyCode);
		//console.log(document.activeElement.tagName);


		var cur_article = document.querySelector(".focus");
		if(cur_article){
			if( event.keyCode === 74){
				cur_article.classList.remove("focus");
				cur_article = findNextArticle(cur_article);
				window.scrollTo(0, cur_article.offsetTop);
				cur_article.classList.add("focus");

			} else if( event.keyCode === 75){
				cur_article.classList.remove("focus");
				cur_article = findePreviousArticle(cur_article);
				window.scrollTo(0, cur_article.offsetTop);
				cur_article.classList.add("focus");
			}
		}else{
			cur_article = findCurrentArticle();
			cur_article.classList.add("focus");
		}
		console.log(cur_article);
	}
};

function findePreviousArticle(article){
	do {
		article = article.previousSibling; 
	}while(article.tagName !== "ARTICLE");
	return article;
}

function findNextArticle(article){
	do {
		article = article.nextSibling; 
	}while(article.tagName !== "ARTICLE");
	return article;
}

function findCurrentArticle(){
	console.log(window.pageYOffset);
	var articles = document.querySelector("#content").childNodes;

	for (var i = 0; i < articles.length; i++) {
		if(articles[i].tagName === "ARTICLE"){
			var top = articles[i].offsetTop;
			var bottom = top + articles[i].offsetHeight;
			if(window.pageYOffset+200 > top-10 && window.pageYOffset+200 < bottom){
				//may this position is article that a user is watching.
				//console.log(articles[i]);
				return articles[i];
			}
		}
	}
}


var main_content = document.getElementById("content");

main_content.addEventListener('click', function(event){
	//var std = { like_num:10, comment_num:5, shared_num:0 };

	// console.log(event.target);
	var eventA = event.target.closest('a');
	if (eventA === null){
		return;
	}
	
	eventA.classList.toggle('blue');
	var icon = eventA.querySelector('i');
	//console.log(eventA);
	icon.classList.toggle('blue');

	var eventDiv = event.target.closest('.art_footer');
	var targetClass = event.target.closest('.art_buttons > span').classList;

	var query = '.';
	var str = '';

	if(targetClass.contains("like_button")){
		str += 'like_num';
	}else if(targetClass.contains("comment_button")){
		str += 'comment_num';
	}else if(targetClass.contains("shared_button")){
		str += 'shared_num';
	}else{

	}
	query += str;
	var num = eventDiv.querySelector(query).innerText;
	
	if(icon.classList.contains("blue")){
		num++;
		eventDiv.querySelector(query).innerText = num;
	}
	else {
		num--;
		eventDiv.querySelector(query).innerText = num;
	}
});


while(scroll_down() < 100 && article_loading < 1);

document.addEventListener('scroll', scroll_down);
document.addEventListener('keydown', keydown);


</script>
</body>
</html>
